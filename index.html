<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAC-OPS: The NotebookLM Arcade</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-pink: #ff00ff;
            --neon-blue: #00ffff;
            --neon-yellow: #ffff00;
            --neon-red: #ff0000;
            --bg-color: #111;
            --screen-bg: #000;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* Impedisce la selezione del testo per feeling da app */
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: white;
            font-family: 'Press Start 2P', cursive;
            overflow: hidden; /* Niente scrollbar */
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Container Principale che mantiene l'Aspect Ratio */
        #arcade-cabinet {
            width: 1024px;
            height: 768px;
            background-color: var(--screen-bg);
            border: 20px solid #333;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.2), inset 0 0 100px rgba(0,0,0,0.8);
            position: relative;
            overflow: hidden;
            transform-origin: center center;
            transition: transform 0.2s ease;
        }

        /* Effetto Scanline CRT */
        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.2) 50%,
                rgba(0,0,0,0.2)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 100;
        }

        /* UI Elements Generali */
        .game-screen {
            display: none; /* Nasconde tutte le schermate di default */
            width: 100%;
            height: 100%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px;
            position: absolute;
            top: 0;
            left: 0;
        }

        .active {
            display: flex; /* Mostra la schermata attiva */
            animation: fadeIn 0.5s;
        }

        h1 {
            color: var(--neon-yellow);
            text-shadow: 4px 4px var(--neon-pink);
            font-size: 2.5rem;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        p {
            color: #ccc;
            line-height: 1.8;
            font-size: 1rem;
            max-width: 800px;
            margin-bottom: 2rem;
        }

        .btn {
            background: transparent;
            border: 4px solid var(--neon-blue);
            color: var(--neon-blue);
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            padding: 20px 40px;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.2s;
            animation: pulse 2s infinite;
        }

        .btn:hover {
            background: var(--neon-blue);
            color: black;
            box-shadow: 0 0 20px var(--neon-blue);
        }

        /* ZALLY CHARACTER - STILI */
        .zally-container {
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }
        
        /* Questo Ã¨ il placeholder per Zally. 
           Quando avrai l'immagine, rimuovi background e border-radius e usa il tag img */
        .zally-sprite {
            width: 100px;
            height: 100px;
            background-color: var(--neon-yellow); 
            border-radius: 50%; /* Pacman style default */
            display: inline-block;
            position: relative;
            /* Se usi un'immagine, togli il commento sotto e metti l'URL */
            /* background-image: url('zally.png'); background-size: contain; background-repeat: no-repeat; background-color: transparent; border-radius: 0; */
        }
        
        /* Bocca di Pacman CSS (solo se non c'Ã¨ immagine) */
        .zally-sprite::after {
            content: '';
            position: absolute;
            top: 20px;
            right: 0;
            width: 40px;
            height: 40px;
            background: black;
            clip-path: polygon(100% 0, 0 50%, 100% 100%);
        }

        /* --- LIVELLI SPECIFICI --- */

        /* Intro */
        .coin-slot {
            margin-top: 30px;
            color: var(--neon-red);
            font-size: 0.8rem;
            animation: blink 1s infinite;
        }

        /* Level 1: Ingestion */
        .file-zone {
            display: flex;
            gap: 20px;
            margin: 40px 0;
        }
        .doc-file {
            width: 80px;
            height: 100px;
            border: 2px solid white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .doc-file:hover { transform: scale(1.1); border-color: var(--neon-pink); color: var(--neon-pink); }
        .notebook-maw {
            width: 150px;
            height: 150px;
            border: 4px dashed var(--neon-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            color: var(--neon-blue);
        }

        /* Level 2: Summary */
        .ghost-container {
            font-size: 5rem;
            color: var(--neon-red);
            margin: 20px;
            transition: all 1s;
        }
        .summary-text {
            display: none;
            text-align: left;
            font-size: 0.8rem;
            color: var(--neon-blue);
            border: 2px solid var(--neon-blue);
            padding: 20px;
        }

        /* Level 3: Q&A */
        .chat-interface {
            width: 80%;
            border: 2px solid #555;
            padding: 10px;
            background: #222;
        }
        .chat-input {
            width: 100%;
            background: black;
            border: 1px solid var(--neon-blue);
            color: white;
            padding: 10px;
            font-family: 'Press Start 2P';
            margin-top: 10px;
        }
        .citation-box {
            display: none;
            margin-top: 20px;
            color: var(--neon-yellow);
            font-size: 0.7rem;
        }
        .highlight { background-color: #333; padding: 2px; border: 1px solid var(--neon-pink); }

        /* Level 4: Audio */
        .visualizer {
            display: flex;
            gap: 5px;
            height: 100px;
            align-items: flex-end;
            margin: 40px auto;
        }
        .bar {
            width: 20px;
            background-color: var(--neon-pink);
            animation: equalizer 0.5s infinite ease-in-out;
        }
        .bar:nth-child(2) { animation-delay: 0.1s; background-color: var(--neon-blue); }
        .bar:nth-child(3) { animation-delay: 0.2s; background-color: var(--neon-yellow); }
        .bar:nth-child(4) { animation-delay: 0.3s; }
        .bar:nth-child(5) { animation-delay: 0.1s; }

        /* Animations */
        @keyframes blink { 50% { opacity: 0; } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes equalizer { 0% { height: 20px; } 50% { height: 100px; } 100% { height: 20px; } }

        /* Instructions Overlay */
        #instructions {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6rem;
            color: #666;
            z-index: 200;
        }

    </style>
</head>
<body>

    <div id="arcade-cabinet">
        <div class="scanlines"></div>

        <!-- INTRO SCREEN -->
        <div id="screen-intro" class="game-screen active">
            <div class="zally-container">
                <!-- ZALLY: Sostituisci il div sotto con <img src="zally.png" class="zally-sprite" alt="Zally"> -->
                <div class="zally-sprite"></div> 
            </div>
            <h1>PAC-OPS<br><span style="font-size: 1.5rem; color:white;">vs INFO-GHOSTS</span></h1>
            <p>Il labirinto dei processi Ã¨ pieno di fantasmi.<br>Usa NotebookLM per ripulire l'area!</p>
            <button class="btn" onclick="nextLevel('screen-intro', 'screen-level1')">INSERT COIN</button>
            <div class="coin-slot">PRESS BUTTON TO START</div>
        </div>

        <!-- LEVEL 1: INGESTION -->
        <div id="screen-level1" class="game-screen">
            <h2>LEVEL 1: THE MAZE</h2>
            <p>I documenti YF&K ti bloccano la strada!</p>
            
            <div class="file-zone">
                <div class="doc-file" onclick="ingestFile(this)">PDF<br>Process</div>
                <div class="doc-file" onclick="ingestFile(this)">GDoc<br>Brief</div>
                <div class="doc-file" onclick="ingestFile(this)">Link<br>Web</div>
            </div>

            <div class="notebook-maw" id="notebook-maw">
                DROP HERE
            </div>

            <p id="l1-feedback" style="visibility: hidden; color: var(--neon-blue);">FONTI ACQUISITE!</p>
            <button id="btn-l1" class="btn" style="display:none;" onclick="nextLevel('screen-level1', 'screen-level2')">NEXT LEVEL >></button>
        </div>

        <!-- LEVEL 2: SUMMARY -->
        <div id="screen-level2" class="game-screen">
            <h2>LEVEL 2: GHOST BUSTING</h2>
            <p>Appare il "Manuale Fornitori 2025" (50 Pagine)!<br>Ãˆ troppo lungo da leggere!</p>
            
            <div class="ghost-container" id="ghost">ðŸ‘»</div>
            
            <div class="summary-text" id="summary-text">
                > KEY TOPICS GENERATED:<br><br>
                * Nuove penali resi<br>
                * Deadline spostata alle 14:00<br>
                * Aggiornamento Sustainability
            </div>

            <button class="btn" id="btn-power" onclick="activatePowerPellet()">USA POWER PELLET (SUMMARIZE)</button>
            <button class="btn" id="btn-l2" style="display:none; margin-top: 20px;" onclick="nextLevel('screen-level2', 'screen-level3')">NEXT LEVEL >></button>
        </div>

        <!-- LEVEL 3: Q&A -->
        <div id="screen-level3" class="game-screen">
            <h2>LEVEL 3: SNIPER SHOT</h2>
            <p>Fornitore arrabbiato in linea!<br>"Qual Ã¨ la regola sui resi danneggiati?"</p>
            
            <div class="chat-interface">
                <div style="text-align: left; margin-bottom: 10px;">CHAT CON LE FONTI:</div>
                <input type="text" class="chat-input" value="Regola resi danneggiati..." readonly>
            </div>

            <div class="citation-box" id="citation-box">
                > RISPOSTA:<br>
                I resi danneggiati devono essere segnalati entro 48h. <br>
                <span class="highlight">Fonte: Manuale pag. 12 [1]</span>
            </div>

            <br>
            <button class="btn" id="btn-ask" onclick="askQuestion()">CHIEDI A ZALLY</button>
            <button class="btn" id="btn-l3" style="display:none; margin-top: 20px;" onclick="nextLevel('screen-level3', 'screen-level4')">NEXT LEVEL >></button>
        </div>

        <!-- LEVEL 4: AUDIO -->
        <div id="screen-level4" class="game-screen">
            <h2>LEVEL 4: BONUS STAGE</h2>
            <p>Sei in metro. Non puoi leggere.<br>Attiva l'Audio Overview!</p>
            
            <div class="visualizer" id="visualizer" style="opacity: 0.2;">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>

            <button class="btn" id="btn-audio" onclick="playAudio()">PLAY PODCAST ðŸŽ§</button>
            <button class="btn" id="btn-l4" style="display:none; margin-top: 20px;" onclick="nextLevel('screen-level4', 'screen-end')">FINISH</button>
        </div>

        <!-- END SCREEN -->
        <div id="screen-end" class="game-screen">
            <h1 style="color: var(--neon-pink);">HIGH SCORE!</h1>
            <div class="zally-container">
                <div class="zally-sprite"></div>
            </div>
            <p>HAI DOMATO IL LABIRINTO!</p>
            <p style="font-size: 0.8rem; color: white;">Challenge completata.<br>Ora tocca a te usare NotebookLM sui ticket reali.</p>
            
            <div style="border: 2px solid white; padding: 20px; margin-top: 20px;">
                <p>Inserisci le tue iniziali:</p>
                <span style="font-size: 2rem; letter-spacing: 10px; color: var(--neon-yellow);">YF&K</span>
            </div>
            
            <br>
            <button class="btn" onclick="location.reload()">PLAY AGAIN</button>
        </div>

        <div id="instructions">ZOOM AUTOMATICO ATTIVO - CREATED BY GEMINI CHAMPION</div>
    </div>

    <script>
        // --- GESTIONE ZOOM/RISOLUZIONE ---
        // Questa funzione adatta il gioco alla finestra del browser
        function resizeGame() {
            const gameContainer = document.getElementById('arcade-cabinet');
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            // Dimensioni base del gioco
            const baseWidth = 1024;
            const baseHeight = 768;

            // Calcola il fattore di scala (mantiene margine del 5%)
            const scaleX = (windowWidth * 0.95) / baseWidth;
            const scaleY = (windowHeight * 0.95) / baseHeight;
            const scale = Math.min(scaleX, scaleY);

            gameContainer.style.transform = `scale(${scale})`;
        }

        window.addEventListener('resize', resizeGame);
        window.addEventListener('load', resizeGame);


        // --- LOGICA DI GIOCO ---

        function nextLevel(currentId, nextId) {
            document.getElementById(currentId).classList.remove('active');
            document.getElementById(nextId).classList.add('active');
        }

        // Level 1 Logic
        let filesIngested = 0;
        function ingestFile(element) {
            element.style.opacity = '0';
            element.style.pointerEvents = 'none';
            filesIngested++;
            
            // Animazione "mangia file"
            const maw = document.getElementById('notebook-maw');
            maw.style.borderColor = 'var(--neon-pink)';
            setTimeout(() => maw.style.borderColor = 'var(--neon-blue)', 200);

            if (filesIngested === 3) {
                document.getElementById('l1-feedback').style.visibility = 'visible';
                document.getElementById('btn-l1').style.display = 'inline-block';
            }
        }

        // Level 2 Logic
        function activatePowerPellet() {
            const ghost = document.getElementById('ghost');
            const summary = document.getElementById('summary-text');
            const btn = document.getElementById('btn-power');
            
            // Ghost scappa/scompare
            ghost.style.transform = 'scale(0)';
            setTimeout(() => {
                ghost.style.display = 'none';
                summary.style.display = 'block'; // Mostra sommario
                summary.classList.add('active'); // fade in
                
                btn.style.display = 'none';
                document.getElementById('btn-l2').style.display = 'inline-block';
            }, 500);
        }

        // Level 3 Logic
        function askQuestion() {
            const btn = document.getElementById('btn-ask');
            const box = document.getElementById('citation-box');
            
            btn.innerHTML = "ANALYZING...";
            setTimeout(() => {
                btn.style.display = 'none';
                box.style.display = 'block';
                box.classList.add('active');
                document.getElementById('btn-l3').style.display = 'inline-block';
            }, 1000);
        }

        // Level 4 Logic
        function playAudio() {
            const viz = document.getElementById('visualizer');
            const btn = document.getElementById('btn-audio');
            
            viz.style.opacity = '1';
            btn.innerHTML = "PLAYING...";
            
            setTimeout(() => {
                document.getElementById('btn-l4').style.display = 'inline-block';
            }, 1500);
        }

    </script>
</body>
</html>
